{% extends 'base.html' %}
{% load static %}

{% block title %}Lista de Productos{% endblock %}

{% block content %}
<div class="mt-4 mb-5" style="padding-left: 100px;padding-right: 100px;">

    <!-- Header -->
    <div class="page-header bg-slate-neutral">
        <div class="d-flex justify-content-between align-items-center flex-wrap gap-3">
            <h2 class="text-slate-light">
                <i class="fas fa-boxes"></i>
                <span>Gestión de Productos</span>
            </h2>
            <a href="{% url 'producto_crear' %}" class="btn btn-create">
                <i class="fas fa-plus"></i> Nuevo Producto
            </a>
        </div>
    </div>

    <!-- Mensajes -->
    <div id="mensajesContainer">
        {% if messages %}
            {% for message in messages %}
            <div class="alert alert-{{ message.tags }} alert-dismissible fade show">
                <i class="fas fa-check-circle me-2"></i>
                {{ message }}
                <button class="btn-close" data-bs-dismiss="alert"></button>
            </div>
            {% endfor %}
        {% endif %}
    </div>

    <!-- Filtros de Búsqueda -->
    <div class="card filter-card mb-3">
        <div class="card-body">
            <form id="filterForm" class="row g-3">
                <div class="col-md-3">
                    <label class="form-label">
                        <i class="fas fa-folder me-1"></i>Categoría
                    </label>
                    <select name="categoria" id="categoria" class="form-select">
                        <option value="">Todas</option>
                        {% for cat in categorias %}
                        <option value="{{ cat.idCategoria }}" {% if filtros.categoria|stringformat:"s" == cat.idCategoria|stringformat:"s" %}selected{% endif %}>
                            {{ cat.descripcion }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
                
                <div class="col-md-3">
                    <label class="form-label">
                        <i class="fas fa-tag me-1"></i>Marca
                    </label>
                    <select name="marca" id="marca" class="form-select">
                        <option value="">Todas</option>
                        {% for m in marcas %}
                        <option value="{{ m.idMarca }}" {% if filtros.marca|stringformat:"s" == m.idMarca|stringformat:"s" %}selected{% endif %}>
                            {{ m.nombre }}
                        </option>
                        {% endfor %}
                    </select>
                </div>
                
                <div class="col-md-2">
                    <label class="form-label">
                        <i class="fas fa-toggle-on me-1"></i>Estado
                    </label>
                    <select name="estado" id="estado" class="form-select">
                        <option value="">Todos</option>
                        <option value="activo" {% if filtros.estado == "activo" %}selected{% endif %}>Activo</option>
                        <option value="inactivo" {% if filtros.estado == "inactivo" %}selected{% endif %}>Inactivo</option>
                    </select>
                </div>
                
                <div class="col-md-3">
                    <label class="form-label">
                        <i class="fas fa-search me-1"></i>Código
                    </label>
                    <input type="text" name="codigo" id="codigo" class="form-control" 
                           placeholder="Buscar por código..." value="{{ filtros.codigo }}">
                </div>
                
                <div class="col-md-1 d-flex align-items-end">
                    <button type="button" id="btnLimpiarFiltros" class="btn btn-secondary w-100" title="Limpiar filtros">
                        <i class="fas fa-eraser"></i>
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Card Principal -->
    <div class="products-card card">
        <div class="card-body p-0">
            <div id="productosContainer">
                {% if productos %}
                <div class="table-responsive">
                    <table class="table border-light table-hover mb-0">
                        <thead class="bg-slate-primary">
                            <tr>
                                <th class="text-slate-primary">#</th>
                                <th class="text-slate-primary">Código</th>
                                <th class="text-slate-primary">Nombre</th>
                                <th class="text-slate-primary">Marca</th>
                                <th class="text-slate-primary">Categoría</th>
                                <th class="text-slate-primary">Precio</th>
                                <th class="text-slate-primary">Stock</th>
                                <th class="text-slate-primary">Estado</th>
                                <th class="text-center text-slate-primary">Acciones</th>
                            </tr>
                        </thead>
                        <tbody id="productosTableBody">
                            {% for p in productos %}
                            <tr>
                                <td>
                                    <span class="badge-id">{{ p.idProducto }}</span>
                                </td>
                                <td>
                                    <span class="badge-code">{{ p.codProducto }}</span>
                                </td>
                                <td>
                                    <strong>{{ p.nombre }}</strong>
                                </td>
                                <td>
                                    <i class="fas fa-tag me-1" style="color: var(--slate-accent);"></i>
                                    {{ p.idMarca.nombre }}
                                </td>
                                <td>
                                    <i class="fas fa-folder me-1" style="color: var(--slate-accent);"></i>
                                    {{ p.idCategoria.descripcion }}
                                </td>
                                <td>
                                    <span class="badge-price">${{ p.precioUnitario }}</span>
                                </td>
                                <td>
                                    {% if p.stock >= 15 %}
                                        <span class="badge-stock high">
                                            <i class="fas fa-check-circle me-1"></i>{{ p.stock }}
                                        </span>
                                    {% elif p.stock > 10 %}
                                        <span class="badge-stock medium">
                                            <i class="fas fa-exclamation-triangle me-1"></i>{{ p.stock }}
                                        </span>
                                    {% else %}
                                        <span class="badge-stock low">
                                            <i class="fas fa-exclamation-circle me-1"></i>{{ p.stock }}
                                        </span>
                                    {% endif %}
                                </td>
                                <td>
                                    {% if p.activo %}
                                        <span class="badge-stock high">
                                            <i class="fas fa-check-circle me-1"></i>Activo
                                        </span>
                                    {% else %}
                                        <span class="badge-stock low">
                                            <i class="fa-solid fa-circle-xmark me-1"></i>Inactivado
                                        </span>
                                    {% endif %}
                                </td>
                                <td>
                                    <div class="action-buttons">
                                        <a href="{% url 'producto_editar' p.idProducto %}" 
                                           class="btn btn-action btn-edit" 
                                           title="Editar">
                                            <i class="fas fa-edit"></i>
                                        </a>
                                        <a href="{% url 'producto_detalle' p.idProducto %}" 
                                           class="btn btn-action btn-view" 
                                           title="Ver detalle">
                                            <i class="fas fa-eye"></i>
                                        </a>
                                        <button class="btn btn-action btn-delete" 
                                                onclick="confirmarEliminar('{{ p.idProducto }}')"
                                                title="Desactivar">
                                            <i class="fas fa-trash-alt"></i>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            {% endfor %}
                        </tbody>
                    </table>
                </div>

                <!-- Paginación -->
                <div class="pagination-container">
                    <div class="pagination-info">
                        Mostrando {{ productos.start_index }} - {{ productos.end_index }} de {{ productos.paginator.count }} productos
                    </div>
                    <nav>
                        <ul class="pagination mb-0">
                            {% if productos.has_previous %}
                            <li class="page-item">
                                <a class="page-link" href="#" onclick="cargarPagina(1); return false;">
                                    <i class="fas fa-angle-double-left"></i>
                                </a>
                            </li>
                            <li class="page-item">
                                <a class="page-link" href="#" onclick="cargarPagina('{{ productos.previous_page_number }}'); return false;">
                                    <i class="fas fa-angle-left"></i>
                                </a>
                            </li>
                            {% endif %}

                            {% for num in productos.paginator.page_range %}
                                {% if productos.number == num %}
                                <li class="page-item active">
                                    <span class="page-link">{{ num }}</span>
                                </li>
                                {% elif num > productos.number|add:'-3' and num < productos.number|add:'3' %}
                                <li class="page-item">
                                    <a class="page-link" href="#" onclick="cargarPagina('{{ num }}'); return false;">{{ num }}</a>
                                </li>
                                {% endif %}
                            {% endfor %}

                            {% if productos.has_next %}
                            <li class="page-item">
                                <a class="page-link" href="#" onclick="cargarPagina('{{ productos.next_page_number }}'); return false;">
                                    <i class="fas fa-angle-right"></i>
                                </a>
                            </li>
                            <li class="page-item">
                                <a class="page-link" href="#" onclick="cargarPagina('{{ productos.paginator.num_pages }}'); return false;">
                                    <i class="fas fa-angle-double-right"></i>
                                </a>
                            </li>
                            {% endif %}
                        </ul>
                    </nav>
                </div>

                {% else %}
                <div class="empty-state">
                    <i class="fas fa-boxes"></i>
                    <h4>No hay productos registrados</h4>
                    <p class="mb-0">Comienza agregando tu primer producto al inventario</p>
                    <div class="mt-3">
                        <a href="{% url 'producto_crear' %}" class="btn btn-empty-state">
                            <i class="fas fa-plus-circle"></i>
                            Crear Primer Producto
                        </a>
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>
</div>

<!-- Modal de Confirmación de Eliminación -->
<div class="modal fade" id="modalEliminar" tabindex="-1" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered">
        <div class="modal-content">
            <div class="modal-header bg-danger text-white">
                <h5 class="modal-title">
                    <i class="fas fa-exclamation-triangle me-2"></i>
                    Confirmar Desactivación
                </h5>
                <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body text-center py-4">
                <i class="fas fa-power-off text-danger" style="font-size: 3rem; opacity: 0.7;"></i>
                <h5 class="mt-3">¿Estás seguro de desactivar este producto?</h5>
                <p class="text-muted mb-0">
                    <strong id="productoNombre"></strong><br>
                    <small>Código: <span id="productoCodigo"></span></small>
                </p>
                <div class="alert alert-warning mt-3 mb-0">
                    <small><i class="fas fa-info-circle me-1"></i>El producto será marcado como inactivo</small>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">
                    <i class="fas fa-times me-1"></i>Cancelar
                </button>
                <button type="button" class="btn btn-danger" onclick="eliminarProducto()">
                    <i class="fas fa-power-off me-1"></i>Desactivar
                </button>
            </div>
        </div>
    </div>
</div>
<script>
let productoIdEliminar = null;

// Cargar productos con AJAX
function cargarProductos(pagina = 1) {
    const formData = new FormData(document.getElementById('filterForm'));
    formData.append('page', pagina);
    
    const params = new URLSearchParams(formData);
    
    fetch(`?${params.toString()}`, {
        method: 'GET',
        headers: {
            'X-Requested-With': 'XMLHttpRequest'
        }
    })
    .then(response => response.json())
    .then(data => {
        actualizarTabla(data);
        actualizarPaginacion(data);
        
        // Actualizar URL sin recargar
        const newUrl = `${window.location.pathname}?${params.toString()}`;
        window.history.pushState({}, '', newUrl);
    })
    .catch(error => {
        console.error('Error:', error);
    });
}

// Actualizar tabla con productos
function actualizarTabla(data) {
    const container = document.getElementById('productosContainer');
    
    if (data.productos.length === 0) {
        container.innerHTML = `
            <div class="empty-state">
                <i class="fas fa-boxes"></i>
                <h4>No se encontraron productos</h4>
                <p class="mb-0">Intenta modificar los filtros de búsqueda</p>
            </div>
        `;
        return;
    }
    
    // Si hay productos, construir la tabla completa
    let html = '';
    data.productos.forEach(p => {
        const stockClass = p.stock >= 15 ? 'high' : (p.stock > 10 ? 'medium' : 'low');
        const stockIcon = p.stock >= 15 ? 'check-circle' : (p.stock > 10 ? 'exclamation-triangle' : 'exclamation-circle');
        const estadoClass = p.activo ? 'high' : 'low';
        const estadoIcon = p.activo ? 'check-circle' : 'circle-xmark';
        const estadoTexto = p.activo ? 'Activo' : 'Inactivado';
        
        html += `
            <tr>
                <td><span class="badge-id">${p.idProducto}</span></td>
                <td><span class="badge-code">${p.codProducto}</span></td>
                <td><strong>${p.nombre}</strong></td>
                <td><i class="fas fa-tag me-1" style="color: var(--slate-accent);"></i>${p.marca}</td>
                <td><i class="fas fa-folder me-1" style="color: var(--slate-accent);"></i>${p.categoria}</td>
                <td><span class="badge-price">$${p.precioUnitario}</span></td>
                <td>
                    <span class="badge-stock ${stockClass}">
                        <i class="fas fa-${stockIcon} me-1"></i>${p.stock}
                    </span>
                </td>
                <td>
                    <span class="badge-stock ${estadoClass}">
                        <i class="fa-solid fa-${estadoIcon} me-1"></i>${estadoTexto}
                    </span>
                </td>
                <td>
                    <div class="action-buttons">
                        <a href="/productos/editar/${p.idProducto}/" class="btn btn-action btn-edit" title="Editar">
                            <i class="fas fa-edit"></i>
                        </a>
                        <a href="/productos/detalle/${p.idProducto}/" class="btn btn-action btn-view" title="Ver detalle">
                            <i class="fas fa-eye"></i>
                        </a>
                        <button class="btn btn-action btn-delete" onclick="confirmarEliminar(${p.idProducto})" title="Desactivar">
                            <i class="fas fa-trash-alt"></i>
                        </button>
                    </div>
                </td>
            </tr>
        `;
    });
    
    // Reconstruir toda la estructura de la tabla
    container.innerHTML = `
        <div class="table-responsive">
            <table class="table border-light table-hover mb-0">
                <thead class="bg-slate-primary">
                    <tr>
                        <th class="text-slate-primary">#</th>
                        <th class="text-slate-primary">Código</th>
                        <th class="text-slate-primary">Nombre</th>
                        <th class="text-slate-primary">Marca</th>
                        <th class="text-slate-primary">Categoría</th>
                        <th class="text-slate-primary">Precio</th>
                        <th class="text-slate-primary">Stock</th>
                        <th class="text-slate-primary">Estado</th>
                        <th class="text-center text-slate-primary">Acciones</th>
                    </tr>
                </thead>
                <tbody id="productosTableBody">
                    ${html}
                </tbody>
            </table>
        </div>
        <div class="pagination-container"></div>
    `;
}

// Actualizar paginación
function actualizarPaginacion(data) {
    const container = document.querySelector('.pagination-container');
    
    if (!container) return;
    
    // Si no hay productos, limpiar paginación
    if (data.productos.length === 0) {
        container.innerHTML = '';
        return;
    }
    
    const startIndex = (data.current_page - 1) * 10 + 1;
    const endIndex = Math.min(data.current_page * 10, data.total_count);
    
    let paginacionHTML = `
        <div class="pagination-info">
            Mostrando ${startIndex} - ${endIndex} de ${data.total_count} productos
        </div>
        <nav>
            <ul class="pagination mb-0">
    `;
    
    if (data.has_previous) {
        paginacionHTML += `
            <li class="page-item">
                <a class="page-link" href="#" onclick="cargarPagina(1); return false;">
                    <i class="fas fa-angle-double-left"></i>
                </a>
            </li>
            <li class="page-item">
                <a class="page-link" href="#" onclick="cargarPagina(${data.current_page - 1}); return false;">
                    <i class="fas fa-angle-left"></i>
                </a>
            </li>
        `;
    }
    
    const startPage = Math.max(1, data.current_page - 2);
    const endPage = Math.min(data.total_pages, data.current_page + 2);
    
    for (let i = startPage; i <= endPage; i++) {
        if (i === data.current_page) {
            paginacionHTML += `
                <li class="page-item active">
                    <span class="page-link">${i}</span>
                </li>
            `;
        } else {
            paginacionHTML += `
                <li class="page-item">
                    <a class="page-link" href="#" onclick="cargarPagina(${i}); return false;">${i}</a>
                </li>
            `;
        }
    }
    
    if (data.has_next) {
        paginacionHTML += `
            <li class="page-item">
                <a class="page-link" href="#" onclick="cargarPagina(${data.current_page + 1}); return false;">
                    <i class="fas fa-angle-right"></i>
                </a>
            </li>
            <li class="page-item">
                <a class="page-link" href="#" onclick="cargarPagina(${data.total_pages}); return false;">
                    <i class="fas fa-angle-double-right"></i>
                </a>
            </li>
        `;
    }
    
    paginacionHTML += `
            </ul>
        </nav>
    `;
    
    container.innerHTML = paginacionHTML;
}

// Cargar página específica
function cargarPagina(pagina) {
    cargarProductos(pagina);
}

// Confirmar eliminación (abrir modal)
function confirmarEliminar(idProducto) {
    productoIdEliminar = idProducto;
    
    // Obtener datos del producto
    fetch(`/productos/eliminar/${idProducto}/`, {
        method: 'GET',
        headers: {
            'X-Requested-With': 'XMLHttpRequest'
        }
    })
    .then(response => response.json())
    .then(data => {
        document.getElementById('productoNombre').textContent = data.nombre;
        document.getElementById('productoCodigo').textContent = data.codigo;
        
        // Mostrar modal
        const modal = new bootstrap.Modal(document.getElementById('modalEliminar'));
        modal.show();
    })
    .catch(error => {
        console.error('Error:', error);
        alert('Error al cargar los datos del producto');
    });
}

// Eliminar producto
function eliminarProducto() {
    if (!productoIdEliminar) return;
    
    fetch(`/productos/eliminar/${productoIdEliminar}/`, {
        method: 'POST',
        headers: {
            'X-Requested-With': 'XMLHttpRequest',
            'X-CSRFToken': getCookie('csrftoken')
        }
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            // Cerrar modal
            const modal = bootstrap.Modal.getInstance(document.getElementById('modalEliminar'));
            modal.hide();
            
            // Mostrar mensaje
            mostrarMensaje('success', data.message);
            
            // Recargar productos
            const currentPage = new URLSearchParams(window.location.search).get('page') || 1;
            cargarProductos(currentPage);
        } else {
            alert('Error al desactivar el producto');
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('Error al procesar la solicitud');
    });
}

// Mostrar mensaje de alerta
function mostrarMensaje(tipo, mensaje) {
    const alertDiv = document.createElement('div');
    alertDiv.className = `alert alert-${tipo} alert-dismissible fade show`;
    alertDiv.innerHTML = `
        <i class="fas fa-check-circle me-2"></i>
        ${mensaje}
        <button class="btn-close" data-bs-dismiss="alert"></button>
    `;
    
    const container = document.getElementById('mensajesContainer');
    container.innerHTML = '';
    container.appendChild(alertDiv);
    
    // Auto-cerrar después de 5 segundos
    setTimeout(() => {
        alertDiv.remove();
    }, 5000);
}

// Obtener CSRF token
function getCookie(name) {
    let cookieValue = null;
    if (document.cookie && document.cookie !== '') {
        const cookies = document.cookie.split(';');
        for (let i = 0; i < cookies.length; i++) {
            const cookie = cookies[i].trim();
            if (cookie.substring(0, name.length + 1) === (name + '=')) {
                cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
                break;
            }
        }
    }
    return cookieValue;
}

// Event listeners
document.addEventListener('DOMContentLoaded', function() {
    // Filtros con cambio automático
    const filtros = ['categoria', 'marca', 'estado'];
    filtros.forEach(filtro => {
        const elemento = document.getElementById(filtro);
        if (elemento) {
            elemento.addEventListener('change', function() {
                cargarProductos(1);
            });
        }
    });
    
    // Búsqueda por código con delay
    let timeoutId;
    const codigoInput = document.getElementById('codigo');
    if (codigoInput) {
        codigoInput.addEventListener('input', function() {
            clearTimeout(timeoutId);
            timeoutId = setTimeout(() => {
                cargarProductos(1);
            }, 500);
        });
    }
    
    // Botón limpiar filtros
    const btnLimpiar = document.getElementById('btnLimpiarFiltros');
    if (btnLimpiar) {
        btnLimpiar.addEventListener('click', function() {
            document.getElementById('filterForm').reset();
            cargarProductos(1);
        });
    }
});
</script>
<style>
    /* Estilos del card de filtros */
    .filter-card {
        border: none;
        border-radius: 1rem;
        box-shadow: 0 2px 8px rgba(15, 23, 42, 0.08);
        animation: slideInDown 0.3s ease;
    }

    .filter-card .form-label {
        font-weight: 600;
        color: var(--slate-secondary);
        font-size: 0.875rem;
        margin-bottom: 0.5rem;
    }

    .filter-card .form-select,
    .filter-card .form-control {
        border: 2px solid #e2e8f0;
        border-radius: 0.5rem;
        padding: 0.6rem 0.75rem;
        font-size: 0.875rem;
        transition: all 0.2s ease;
    }

    .filter-card .form-select:focus,
    .filter-card .form-control:focus {
        border-color: var(--slate-primary);
        box-shadow: 0 0 0 0.2rem rgba(51, 65, 85, 0.15);
    }

    /* Contenedor de paginación */
    .pagination-container {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 1.5rem;
        background: #f8fafc;
        border-top: 1px solid #e2e8f0;
    }

    .pagination-info {
        color: var(--slate-secondary);
        font-size: 0.875rem;
        font-weight: 500;
    }

    .pagination {
        gap: 0.25rem;
    }

    .page-link {
        border: none;
        color: var(--slate-secondary);
        background: white;
        border-radius: 0.5rem;
        padding: 0.5rem 0.75rem;
        font-weight: 500;
        transition: all 0.2s ease;
    }

    .page-link:hover {
        background: var(--slate-primary);
        color: white;
        transform: translateY(-2px);
    }

    .page-item.active .page-link {
        background: var(--slate-primary);
        color: white;
        font-weight: 600;
    }

    /* Header de página */
    .page-header {
        border-radius: 1rem;
        padding: 2rem;
        margin-bottom: 2rem;
        box-shadow: 0 4px 6px rgba(15, 23, 42, 0.1);
    }

    .page-header h2 {
        margin: 0;
        font-weight: 700;
        display: flex;
        align-items: center;
        gap: 1rem;
    }

    .page-header h2 i {
        font-size: 2rem;
        opacity: 0.9;
    }

    /* Botón principal */
    .btn-create {
        background: white;
        color: var(--slate-primary);
        font-weight: 600;
        padding: 0.75rem 1.5rem;
        border-radius: 0.75rem;
        border: none;
        box-shadow: 0 2px 8px rgba(255, 255, 255, 0.2);
        transition: all 0.3s ease;
    }

    .btn-create:hover {
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(255, 255, 255, 0.3);
        background: var(--slate-light);
        color: var(--slate-primary);
    }

    .btn-create i {
        margin-right: 0.5rem;
    }

    /* Alertas mejoradas */
    .alert {
        border: none;
        border-radius: 0.75rem;
        padding: 1rem 1.25rem;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
        animation: slideInDown 0.4s ease;
    }

    @keyframes slideInDown {
        from {
            opacity: 0;
            transform: translateY(-20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    /* Card principal */
    .products-card {
        border: none;
        border-radius: 1rem;
        box-shadow: 0 4px 6px rgba(15, 23, 42, 0.07);
        overflow: hidden;
    }

    /* Tabla mejorada */
    .table-container {
        background: white;
        border-radius: 1rem;
        overflow: hidden;
    }

    .table {
        margin: 0;
    }

    .table thead th {
        color: white;
        font-weight: 600;
        text-transform: uppercase;
        font-size: 0.875rem;
        letter-spacing: 0.5px;
        padding: 1rem;
        border: none;
        vertical-align: middle;
    }

    .table tbody tr {
        transition: all 0.2s ease;
        border-bottom: 1px solid var(--slate-light);
    }

    .table tbody td {
        padding: 1rem;
        vertical-align: middle;
        color: var(--slate-secondary);
        font-weight: 500;
    }

    /* Badges personalizados */
    .badge-id {
        background-color: var(--slate-light);
        color: var(--slate-primary);
        padding: 0.5rem 0.75rem;
        border-radius: 0.5rem;
        font-weight: 600;
        font-size: 0.875rem;
    }

    .badge-code {
        background-color: #e0e7ff;
        color: black;
        padding: 0.4rem 0.8rem;
        border-radius: 0.5rem;
        font-weight: 600;
        font-size: 0.875rem;
        font-family: 'Courier New', monospace;
    }

    .badge-price {
        background-color: #d1fae5;
        color: #065f46;
        padding: 0.5rem 0.85rem;
        border-radius: 0.5rem;
        font-weight: 700;
        font-size: 0.95rem;
    }

    .badge-stock {
        padding: 0.4rem 0.8rem;
        border-radius: 0.5rem;
        font-weight: 600;
        font-size: 0.875rem;
    }

    .badge-stock.high {
        background-color: #d1fae5;
        color: #065f46;
    }

    .badge-stock.medium {
        background-color: #fef3c7;
        color: #ca8f6a;
    }

    .badge-stock.low {
        background-color: #fee2e2;
        color: #991b1b;
    }

    /* Botones de acción */
    .action-buttons {
        display: flex;
        gap: 0.5rem;
        justify-content: center;
        flex-wrap: wrap;
    }

    .btn-action {
        padding: 0.5rem 0.75rem;
        border-radius: 0.5rem;
        border: none;
        transition: all 0.2s ease;
        font-size: 0.875rem;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        min-width: 38px;
    }

    .btn-edit {
        background-color: var(--slate-primary);
        color: white;
    }

    .btn-view {
        background-color: var(--slate-accent);
        color: white;
    }

    .btn-delete {
        background-color: #dc2626;
        color: white;
    }
    .btn-edit:hover {
        background-color: var(--slate-primary);
        color: white;
    }

    .btn-view:hover {
        background-color: var(--slate-accent);
        color: white;
    }

    .btn-delete:hover {
        background-color: #dc2626;
        color: white;
    }

    /* Estado vacío */
    .empty-state {
        text-align: center;
        padding: 3rem 2rem;
        background: linear-gradient(135deg, #f8fafc 0%, #f1f5f9 100%);
        border-radius: 1rem;
        border: 2px dashed var(--slate-neutral);
    }

    .empty-state i {
        font-size: 4rem;
        color: var(--slate-neutral);
        margin-bottom: 1rem;
        opacity: 0.5;
    }

    .empty-state h4 {
        color: var(--slate-secondary);
        margin-bottom: 1rem;
        font-weight: 600;
    }

    .empty-state p {
        color: var(--slate-neutral);
        margin-bottom: 1.5rem;
    }

    .btn-empty-state {
        background-color: var(--slate-primary);
        color: white;
        padding: 0.75rem 2rem;
        border-radius: 0.75rem;
        border: none;
        font-weight: 600;
        transition: all 0.3s ease;
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
    }

    .btn-empty-state:hover {
        background-color: var(--slate-secondary);
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(15, 23, 42, 0.2);
        color: white;
    }

    /* Responsive */
    @media (max-width: 768px) {
        .page-header {
            padding: 1.5rem;
        }

        .page-header h2 {
            font-size: 1.5rem;
            flex-direction: column;
            text-align: center;
            gap: 0.5rem;
        }

        .action-buttons {
            flex-direction: column;
        }

        .table {
            font-size: 0.875rem;
        }

        .table thead th,
        .table tbody td {
            padding: 0.75rem 0.5rem;
        }

        .pagination-container {
            flex-direction: column;
            gap: 1rem;
        }
    }

    /* Animación de carga */
    @keyframes fadeIn {
        from {
            opacity: 0;
            transform: translateY(10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .products-card {
        animation: fadeIn 0.5s ease;
    }

    /* Estilos del modal */
    .modal-content {
        border: none;
        border-radius: 1rem;
        box-shadow: 0 10px 40px rgba(0, 0, 0, 0.2);
    }

    .modal-header {
        border-radius: 1rem 1rem 0 0;
        border-bottom: none;
    }

    .modal-footer {
        border-top: 1px solid #e2e8f0;
        padding: 1.25rem;
    }
</style>
{% endblock %}